#  7.4 \[PS\] Trapezoidal Tiling

![[COMP3121_9101-7.4.pdf#height=700]]


# Example Solution

> [!cite] A solution can be found in Algorithmic Puzzles by Anany Levitin and Maria Levitin, Oxford University Press, 2011, pp. 163−164.

> The intuition: each tile covers 3 unit triangles, so the total number of unit triangles in the region must be a multiple of 3.

![[trapezoidal-tiling.png]]

First we observe that we can reduce this problem into a smaller instance by partitioning the original triangle into four equilateral triangles of half the size by parallel lines to the base dividing each of its sides at the midpoint. Then we can place the longer base of the trapezoid tile in the middle of the triangular base such that every segment now contains a missing triangle. 

The problem can be solved by the following recursive algorithm.
- If $n = 2$, the grid is congruent to one trapezoid tile, so it can be tiled in exactly one way.
- If $n = 2^k$ where $k > 1$, we partition the grid of size $n$ into four equilateral triangle of side size $n/2$ by three lines connecting the midpoints of each side. Then by placing the longer base of the trapezoid tile in the centre of the base such that each triangle now contains a missing triangle at a corner covered by this trapezoid placement, the problem’s instance of size $n$ is now reduced to four smaller instances of the original problem, each of $n/2$. 
- To solve the original problem, we recurse on each of the four grids until the base case  is reached, and combine all the trapezoid placements to obtain a valid tiling of the original grid.

%% 
The proof of the algorithm’s correctness is based on the fact that the properties enumerated above remain valid on each iteration of the algorithm, which can be easily checked by mathematical induction. 

A valid tiling has two properties:
• Every equilateral triangle must be covered by at least one trapezoid. 
• No equilateral triangle may be tiled by more than one trapezoid.

Induction: Prove that if a trapezoid tiling exists for $n=2^k$ where $k \geq 1$, it also exists for $n = 2^{k+1}$.  
%%

To prove the correctness of the algorithm, we proceed by induction. The base case is trivially true, since a grid of length $2$ with one missing triangle is precisely the shape of a trapezoid; therefore, the grid can be tiled by one trapezoid.

Now assume that the algorithm correctly tiles all grids of size $n$. We will prove that if a trapezoid tiling exists for $n=2^k$ where $k \geq 1$, it also exists for $n = 2^{k+1}$.  Consider the case of an equilateral triangle of side length $2^{k+1}$ with its topmost equilateral triangle chopped off. By our algorithm, we divide this into four equilateral triangles of side length $n/2 = 2^{k}$. After placing a trapezoid in the middle of its base such that all four triangles now have a missing triangle in one corner, each sub-triangle is now congruent to the original triangle but with exactly half its size. By the inductive hypothesis, each triangle of side size $2^{k}$ can be tiled by trapezoids with no overlaps. This gives a natural tiling arrangement for the size $n$ grid by combining all four grid segments together, which proves the correctness of the algorithm. 

Let $T(n)$ be the running time of the algorithm on instance of a grid with size $n$. At each recursive step, the algorithm solves four subproblems of size $n/2$ and performs $O(1)$ additional work to combine their results with all previous solutions. Therefore, the recurrence is $T(n) = 4T(n/2) + C$, where $C$ is some fixed constant.

Now, define $c^\ast = \log_2 4=2$. Since $f(n)=C=O(1)$, $T(n)$ satisfies Case 1 of the Master Theorem. Therefore, the running time of the algorithm is $Θ(n^{c^\ast}) = \Theta(n^2)$.


## Example Solution

**Solution** The puzzle has a solution if and only if $n$ is not divisible by $3$.

*Count the number of unit triangles left after chopping off the topmost one.*
Counting the small triangles by the layers starting with the base of the triangular region (of length $n$), we get the following formula:

$$
\begin{align}
T(n) &= \big[n + 2(n - 1) + 2(n - 2) + \cdots + 2 \cdot 1\big] - 1\\
&= n + 2 \cdot \frac{(n - 1)n}{2} - 1 = n^2 - 1.
\end{align}
$$

*The modular-3 invariant.*
Since one trapezoid tile is made up of three small triangles, $n^2 - 1$ must be divisible by $3$ for a tiling to exist. But $n^2 - 1$ is divisible by $3$ if and only if $n$ is not divisible by $3$, which immediately is established by considering the cases of $n = 3k$, $n = 3k + 1$, and $n = 3k + 2$.

*A tiling exists for the full triangle when $n=3k$.*
Before we show that this condition is not only necessary but also sufficient for a tiling existence, let us prove that if $n = 3k$ and no small triangle is removed from the region, it can be tiled by trapezoids. This is easy to prove by induction on $k$. For $k = 1$, the region can be tiled by three trapezoids (Figure 4.62a). Let us prove that if a trapezoid tiling exists for $n = 3k$ where $k \ge 1$, it is also exists for $n = 3(k + 1)$. Consider the line parallel to the base through the points dividing the region’s sides $3 : 3k$ (Figure 4.62b). This line dissects the region into the trapezoid below this line and the equilateral triangle above the line. The former can be dissected into $(k + 1) + k$ equilateral triangles of side size $3$ and hence can be tiled by trapezoid tiles; the latter can be tiled by the inductive assumption.

Now consider the case of an equilateral triangle of side size $n = 3k + 1$ with its topmost equilateral triangle chopped off. After placing $2k$ trapezoids along one of the sides of the region (see Figure 4.63a for an example), we will be left with the task of tiling the whole equilateral triangle of side size $3k$, which can be done as shown above. And if $n = 3k + 2$, we can place $2k + 1$ trapezoids along the region’s base to reduce this instance to that of $n = 3k + 1$ (see Figure 4.63b for an example).

**Comments** The above solution takes advantage of the invariant, decrease-and-conquer, and transform-and-conquer ideas.

It is interesting that for $n = 2^k$, the puzzle can also be solved by the following divide-and-conquer algorithm. If $n = 2$, the region is congruent to one trapezoid tile. If $n = 2^k$ where $k > 1$, place the longer base of the first tile in the middle of the regions’s base. Then draw three straight lines connecting the middle points of the three sides of the triangle from which the region was obtained. This will dissect the region into four congruent subregions similar to the original region but exactly half its size (Figure 4.64a). Hence, each of them can be tiled by the same algorithm, that is, recursively. The algorithm is illustrated in Figure 4.64b for $n = 8$. It is obviously similar to the algorithm for tromino tiling a $2^n \times 2^n$ region with a missing square discussed in the book’s first tutorial.

