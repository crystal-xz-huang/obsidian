
# 5.7 \[DN\] Wall Street Bets

![[COMP3121_9101-5.7.pdf#height=650]]
> [!abstraction]
> <b>Inputs.</b>
> - An integer $n$, the number of days.
> - A sequence $(C_1, C_2, \dots, C_n)$ where $C_i \ge 0$ represents the profit earned by investing on day $i$.
> - A constraint parameter $k$, where $k = 1$ in part (a) and $1 < k < n$ in part (b), indicating the maximum number of **consecutive days ($i$ and $i+1$)** allowed for investment.
> 
> <b>Task.</b>
> Determine the **maximum total profit** Satoshi can achieve by selecting a subset of days to invest such that there are **no more than $k$ consecutive investment days**.

## Part (a) One Consecutive 

- $k=1$: allowed to invest on consecutive days *exactly once* over the $n$ days.
- Investing on days $\{1,2,3\}$ has two consecutive/adjacent days $(1,2)$ and $(2,3)$. 

For example, suppose $k=1$, $n = 6$ and $C = [15, 14, 13, 16, 12, 13]$.

The optimal strategy is to invest on days 1, 2, 4 and 6, for a total of 58 dollars.

Thoughts:
- Consider prefixes of days (first $i$ days; up to day $i$). 
- Need to track which consecutive days were used in the solution.

1. At each day $i$, we have the choice to either invest on day $i$ or not. 
2. If we do invest on day $i$, then we have the following consequence: does this create a consecutive pair with previous day $i-1$? 
	1. If yes, we can't do this if there is already a consecutive pair
	2. If no, then we can invest on day $i$

Therefore, we need to keep track of 3 states:
- days considered
- whether we used up a consecutive pair or not (boolean)
- whether day $i$ was invested or not (boolean)


### Subproblems

For 

### Order of computation

For $1 \leq 1 \leq n$, for $0 \leq u \leq k$,  compute $\operatorname{opt}(i, j, 0)$ and $\operatorname{opt}(i, j, 1)$. 




> [!solution]
> **Subproblems:**
> 
> For all $1\le i\le n$, for all $0\le j\le k$, and for $c\in\{0,1\}$, let
> $$
> \operatorname{opt}(i,j,c)
> $$
> be the maximum total profit that can be achieved over the first $i$ days, with exactly $j$ consecutive investments, and with $c=1$ if day $i$ is invested, $c=0$ otherwise.
> 
> The overall answer (for at most $k$ adjacent pairs) is
> $$
> \max_{0\le j\le k,\; c\in\{0,1\}}\operatorname{DP}(n,j,c).
> $$
> 
> For part (a), restrict $j\in\{0,1\}$ and (if $C_i\ge0$ and $n\ge2$) the maximum will in fact occur at $j=1$.
>
> **Recurrence:**
> 
> For $i\ge2$ and $0\le j\le k$:
> 
> - If day $i$ is **not taken** ($c=0$):
>   $$
>   \operatorname{DP}(i,j,0)
>   = \max\big(\operatorname{DP}(i{-}1,j,0),\ \operatorname{DP}(i{-}1,j,1)\big).
>   $$
> 
> - If day $i$ **is taken** ($c=1$):
>   $$
>   \operatorname{DP}(i,j,1)
>   = C_i+\max\Big(
>       \underbrace{\operatorname{DP}(i{-}1,j,0)}_{\text{no new adjacency}},\ 
>       \underbrace{\operatorname{DP}(i{-}1,j{-}1,1)}_{\text{new adjacency; valid if }j\ge1}
>     \Big),
>   $$
>   where $\operatorname{DP}(i{-}1,j{-}1,1)=-\infty$ if $j=0$.
> 
> **Base cases:**
> 
> For $i=1$:
> $$
> \operatorname{DP}(1,0,0)=0,\qquad
> \operatorname{DP}(1,0,1)=C_1,\qquad
> \operatorname{DP}(1,j,c)=-\infty\text{ for }j>0.
> $$
> 
> **Order of computation:**
> 
> Compute in lexicographic order of $(i,j,c)$:
> 
> - For $i=1,2,\dots,n$  
> - For $j=0,1,\dots,k$  
> - Compute both $c \in \{0, 1\}$. 
> - Compute $\operatorname{DP}(i,j,0)$ then $\operatorname{DP}(i,j,1)$
> 
> This ensures that every dependency $\operatorname{DP}(i{-}1,*,*)$ is already available when computing $\operatorname{DP}(i,*,*)$.
> 
> **Overall answer:**
> 
> $$
> \max_{0\le j\le k,\ c\in\{0,1\}}\operatorname{DP}(n,j,c).
> $$
> 
> For part (a): $k=1$; if $C_i\ge0$ and $n\ge2$, this achieves $j=1$ automatically.
> 
> **Time complexity:**
> 
> There are $O(nk)$ subproblems, each computed in $O(1)$ time, giving total $O(nk)$.
> For part (a), this simplifies to $O(n)$ time and $O(1)$ space.

