# Knuth-Morris-Pratt Example

Recall that in the **Knuth‚ÄìMorris‚ÄìPratt (KMP)** algorithm, we want to find out if some pattern $B = b_1 b_2 \ldots b_m$ appears in some much longer text $A = a_1 a_2 \ldots a_n$.  

We can use a counter $k$ which takes values between $0$ and $m$, indicating how many characters of the pattern have been matched.

For example, if we wanted to match the string **ùö°ùö¢ùö°ùö£ùö°**, we need to have six values; one for each prefix, including the empty string. Then, we transition to different values of $k$ depending on the next character we encounter.

For the rest of this quiz, suppose  
$A = \texttt{xyxyxxzxyxzx yxzx xx}$  
and that  
$B = \texttt{xyxzx}$.

---

### Failure function

Let $B_i$ be the string consisting of the first $i$ characters of $B$.

Fill in the following table, where $\pi$ is the failure function from the KMP algorithm, i.e. $\pi(i)$ is the length of the longest proper suffix of $B_i$ which is also a prefix of $B$.

| $i$ | 1 | 2 | 3 | 4 | 5 |
|-----|---|---|---|---|---|
| $\pi(i)$ | 0 | 0 | 1 | 0 | 1 |

- $\pi(1)$ is trivially $0$; the only proper suffix of **x** is the empty string.  
- For $\pi(2)$, the only nontrivial proper suffix of $A_2 = \texttt{xy}$ is **y**, which cannot be any prefix of $A$; so $\pi(2) = 0$.  
- $\pi(3)$ has $x = a_3$, but also $x = a_1 = a_{\pi(2)+1}$, so $\pi(3) = 1$.  
- $\pi(4)$ is trivially $0$, since **z** is always included in the suffix of $B_i$, and appears nowhere as a prefix of $B$ of length at most three.  
- $\pi(5)$ has **$x = a_5$**, but also **$x = a_1 = a_{\pi(4)+1}$**, so $\pi(5) = 1$.

---

### Matching table

Fill in the table using $\{0,1,2,3,4,5\}$ to show the length of the prefix matches we make when attempting to match $B$ with $A$.  

Recall that  
$A = \texttt{xyxyxxzxyxzx yxzx xx}$  
and that  
$B = \texttt{xyxzx}$.

For example, if you were trying to match $B$ with $A' = \texttt{xyxzx yx}$, you would enter **1234523** in the drop-down boxes, in that order (the first five characters each allow us to extend the partial match, and the sixth lets us extend a shorter partial match of length $1$, which we then continue with).

| $i$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|-----|---|---|---|---|---|---|---|---|---|
| max length prefix match including $A[i]$ | 1 | 2 | 3 | 2 | 3 | 1 | 0 | 1 | 2 |

| $i$ | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 |
|------|----|----|----|----|----|----|----|----|----|
| max length prefix match including $A[i]$ | 3 | 4 | 5 | 2 | 3 | 4 | 5 | 1 | 1 |

**Feedback**

Starting with the empty string, your first entry should be the length of the partial match. Then, we attempt to extend the partial match if possible; if not, we reset the length of the partial match and repeat.  

For example, we encounter **x**, then **y**.  

- The first character, **x**, is the first letter in the search string ‚Äî $1$.  
  So our first entry is $1$, then we look to extend the partial match.  
- The second character, **y**, is the second letter in the search string ‚Äî $2$.  
  So our second entry is $2$, then we look to extend the partial match.  
  If the second character wasn‚Äôt **y**, then we would have reset the length of the prefix match depending on the character encountered: $0$ if we encountered **z**, and $1$ if we encountered **x**.  

Continuing sixteen more times produces the sequence. You could have also made the computation a bit friendlier by noticing that the example input is a substring of $A$.

---

### Counting occurrences

**Question:**  
Then, how many times in the previous question did we find the substring $B = \texttt{xyxzx}$?

**Answer:** 2

This is precisely the number of times we reach the finishing state, or how many times we reach a prefix of length equal to the string itself.




