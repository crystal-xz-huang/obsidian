![[COMP3121_9101-3.5.pdf#height=800]]

# Overview

> [!task]
> Design an algorithm to count the number of ways to completely fill a `n x 4` board 
> with `I-pieces` (1×4 or 4×1) in `O(n)` time.
> 
> - `n x 4` board with `n` rows (height/y-axis) and `4` columns (width/x-axis)
> - `n ≥ 1` so the smallest board is `1 x 4`
> - `I-pieces` has 2 possible rotations: `1 x 4` or `4 x 1` 

> [!goal]
> Find the number of ways to fill a nx4 board using 1×4 and 4×1 tiles.

# Notes

#### Identify optimal substructure and a recursive relationship

![[task-3.5.excalidraw.png]]

> Let `F(n)` be the number of ways to completely fill an n × 4 board with I-pieces.

##### Base cases 

- If `n < 4` (number of rows) then the board can only fit horizontal 1×4 pieces in each row.
- If `n = 4` then there are exactly 2 possible ways to fill a 4x4 board

For `n < 4` (`n = 1,2,3`), a vertical 4×1 piece won’t fit (height too small), so the only possibility is to place one horizontal 1×4 piece per row. Therefore `F(1) = F(2) = F(3) = 1`.

For `n = 4`, two possibilities exist:
- four horizontals (one per row), or
- four verticals (one per column).  
Hence `F(4) = 2`.

> [!note] Base cases
> - `F(1)` = number of ways to fill a 1x4 board = `1`
> - `F(2)` = number of ways to fill a 2x4 board = `1`
> - `F(3)` = number of ways to fill a 3x4 board = `1`
> - `F(4)` = number of ways to fill a 4x4 board = `2`

##### Recursive pattern

The board grows vertically with n so the way to build it up recursively is to ask:

> “How can I extend a smaller filled board to get an n×4 filled board?

> [!example]
> Let's say we know `F(1)`, `F(2)`, `F(3)`, and `F(4)`. How can we find `F(5)` given this information?
> 
> - F(4) is the number of ways to fill up a 4x4 board. 
> - F(5) is the number of ways to fill up a 5x4 board.
> 	- If we use F(4) then we have 1x4 remaining space to fill
> 	- Then we can use F(1) to fill up that remaining space
> 	- F(5) = F(4) + F(1) = 3
>
> $$F(n) = F(n-1) + F(n-4)$$

> [!tldr]
> In general, to fill a board up to `n` rows:
> 
> 1. If we place a **vertical I-piece (1x4)**, it occupies 4 consecutive rows of one column. 
> → This reduces the problem to filling an **(n−4)×4** board. 
> → This can be done in **F(n-4)** ways.
> 
> 2. If we place a **horizontal I-piece (4x1)**, it occupies 4 consecutive columns in a single row.  
> → This reduces the problem to filling an **(n−1)×4** board.
> → This can be done in **F(n−1)** ways.
>     
>    ![[task-3.5-pattern.excalidraw.png|300]]
>    
> If we assume that the smaller subproblems $F(n-4), \ldots, F(n-1)$ are solved, then we can use it to satisfy the recurrence:
>
> $$F(n) = F(n-1) + F(n-4)$$
>
> The bases cases occur when $F(n-4) = 0$, i.e. when $n = 1, 2, 3$ and $4$. 

##### Solution

**Subproblems**

For each $1 \leq i \leq n$, let $F(i)$ denote the total number of ways to completely fill an $i \times 4$ board with two possible orientations of I-pieces.

**Recurrence**

For $i \gt 4$,

$$F(i) = F(i-1) + F(i-4)$$

**Base case**

The base cases occur when $i \leq 4$ with $F(1) = F(2) = F(3) = 1$ and $F(4) = 2$.

- When $i < 4$, the vertical $4 \times 1$ piece does not fit the board, and so the only possibility is to place one horizontal piece per column; therefore $F(1) = F(2) = F(3) = 1$.
- When $i = 4$, both rotations of the I-piece fit the board, therefore we can either use four horizontal pieces (one per row) or four vertical pieces (one per column) and so $F(4) = 2$.

**Order of computation**

Solve subproblems in increasing order of $i$. 

**Overall answer**

$F(n)$

**Time complexity**

There are $O(n)$ subproblems and each subproblem takes $O(1)$ to resolve by the recurrence (using previously computed values). Therefore, the overall time complexity is $O(n)$.

<hr class='dots' />

# Solution

For each $1 \leq i \leq n$, let $F(i)$ denote the total number of ways to completely fill the first $i$ rows of an $i \times 4$ board with I-pieces, which can be placed horizontally as $1\times4$ or vertically as $4\times1$. 

%% Base Cases %%
When $i < 4$, the vertical $4 \times 1$ piece cannot fit the board, and so the only possibility is to place one horizontal piece per row; therefore, for each $1 \leq i < 4$, we have that $F(i) = 1$.

When $i = 4$, we can choose to either use four horizontal $1\times4$ pieces (one per row) or four vertical $4 \times 1$ pieces (one per column); therefore, $F(4) = 2$.

For $i \geq 5$, both orientations can fit and we can choose to either place the I-piece vertically or horizontally in the next unfilled row. We consider these two scenarios separately.

- Case 1. If we place a vertical $4 \times 1$ piece, it occupies four consecutive rows in a single column. In the rows it occupies, there is only one possible way to fill the remaining columns, by placing vertical pieces in each column. Hence, placing a vertical piece completely fills the four rows in exactly one way, and the problem is reduced to filling the remaining $(i−4)$ rows.
- Case 2. If we place a horizontal $1 \times 4$ piece, it completely fills an entire row of four columns. This reduces the problem to filling the remaining $(i−1)$ rows.

Starting from the first row, we fill rows in top-down manner. At each stage we are bounded by the first unfilled row and each case completely fills a fixed number of rows, regardless of placement. Therefore, the final recurrence is given by
$$F(i) = F(i-1) + F(i-4)$$

The base cases occur when $i \leq 4$ with $F(1) = F(2) = F(3) = 1$ and $F(4) = 2$. The final solution is equal to $F(n)$, where we fill in the dynamic programming table in increasing order of $i$.

%% Correctness %%
$\textbf{Correctness.}$ It suffices to prove that the subproblem satisfies the recurrence. For $i = 1, 2, 3$ and $4$ this is easy to check. For $i \geq 5$, assume that all previous subproblems have been solved correctly. Consider the first unfilled row of an $i \times 4$ board. Exactly one of the following must occur to fill the entire row of four columns:

- Case 1. A single horizontal $1 \times 4$ piece is placed, filling the entire row and leaving an $(i-1) \times 4$ board. By the inductive hypothesis, there are $F(i-1)$ ways to fill the remaining portion of the board.
- Case 2. A vertical $4 \times 1$ piece is placed in some column, and the remaining three columns must also be filled with vertical pieces since a horizontal piece does not fit. Each vertical piece spans four consecutive rows in its column, meaning that the next four rows are now fully filled by four vertical pieces. The remaining portion of the board is therefore an $(i-4) \times 4$ board, which can be filled in $F(i-4)$ ways by the inductive hypothesis.

These two cases are mutually exclusive (i.e. the same row cannot contain both a horizontal and a vertical piece) and collectively exhaustive. Therefore, every configuration of an $i \times 4$ board is accounted for exactly once in the sum $F(i) = F(i-1) + F(i-4)$, which implies that the subproblem is solved correctly.

$\textbf{Time complexity analysis.}$ There are $O(n)$ subproblems and each subproblem takes $O(1)$ to resolve by the recurrence. Therefore, the overall time complexity is $O(n)$.

# Notes

- One-Parameter, Constant Recurrence 